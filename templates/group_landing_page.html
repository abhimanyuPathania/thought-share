{% extends 'base.html' %}

{% block title %}
	<title>{{g.name}}</title>
{% endblock %}


{% block content %}
	<div>
		<div>
			<h1>{{g.name}}</h1>
			<img src="{{g.cover_image_url}}" alt="{{g.name}} cover image">
			<p>{{g.description}}</p>
			{% if g.members_number %}
				<p><i>{{g.members_number}} members</i></p>
			{% endif %}
			{% if g.render_edit %}
				<a href="/edit-group/{{g.id}}">Edit this</a>
			{% endif %}
		</div>

		<div>
			<h4>Created by:</h4>
			<p>{{g.creator_name}}</p>
			<img src="{{g.creator_image}}" alt="{{g.creator_name}} photo">
		</div>
	</div>

	<div>
		{% if g.recent_posts %}
			<h2>Recent posts in this group</h2>
			{% for post in g.recent_posts %}
				<div>
					{% if g.poster_info %}
						<div>
							<strong>{{post.poster_name}}</strong>
							<img src="{{post.poster_image}}" alt="{{post.poster_name}}'s photo">
						</div>
					{% endif %}
					<p>{{post.post}}</p>
				</div>
				<hr/>
			{% endfor %}
		<!-- either 0 post in group or its a private group and user not member(default case) -->
		{% else %}
			<!-- public group or a private group with user as member-->
			{% if not g.private or (g.private and g.member) %}
				<h4>No posts in this group yet</h4>
			{% endif %}	
		{% endif %}
	</div>

	<div>
		<!-- A public group -->
		{% if not g.private %}
			
			<!-- user is member of the public group -->
			{% if g.member %}
				<form action="/leave-group/{{g.id}}" method="GET">
					<input type="submit" value="Leave this group">
				</form>

			<!-- not a member so render join button -->
			{% else %}
				<form action="/join-group/{{g.id}}" method="GET">
					<input type="submit" value="Join this group">
				</form>
			{% endif %}
		{% endif %}
		
		<!-- A private group -->
		{% if g.private %}
			
			{% if g.member %}
				<form action="/leave-group/{{g.id}}" method="GET">
					<input type="submit" value="Leave this group">
				</form>
				{% if not g.admin %}
					{% if g.admin_request %}
						<strong>Your request for adminship of this group is pending</strong>
					{% else %}
						<form action="/admin-group/{{g.id}}" method="POST">
							<input type="submit" value="Request Adminship of this group">
						</form>
					{% endif %}
				{% endif %}

			<!-- not a member of private group/ so either we render join or
			user has a pending join request-->
			{% else %}
				{% if g.render_join %}
				<form action="/join-group/{{g.id}}" method="GET">
					<input type="submit" value="Join this group">
				</form>
				{% else %}
					<strong>Your request to join this group is pending</strong>
				{% endif %}
				<!-- <button>Join this group</button> -->
			{% endif %}
		{% endif %}
	</div>
	<span style ="display:none" id="groupData" data-groupJSON="{{group_json}}"></span>
{% endblock %}

